<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>个人记账本</title>
    <link rel="stylesheet" href="src/css/style.css">
    <!-- 添加 Font Awesome 图标 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <!-- Vue.js -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div id="app">
        <header>
            <h1>个人记账本</h1>
            <nav>
                <button @click="currentView = 'record'">记账</button>
                <button @click="currentView = 'list'">记录</button>
                <button @click="currentView = 'statistics'">统计</button>
                <button @click="currentView = 'settings'">设置</button>
            </nav>
        </header>

        <main>
            <!-- 记账表单 -->
            <section v-if="currentView === 'record'" class="record-form">
                <h2>记录新交易</h2>
                <form @submit.prevent="addTransaction">
                    <div class="form-group">
                        <label>类型</label>
                        <select v-model="newTransaction.type" required>
                            <option value="expense">支出</option>
                            <option value="income">收入</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>金额</label>
                        <input type="number" v-model="newTransaction.amount" required min="0" step="0.01">
                    </div>
                    <div class="form-group">
                        <label>类别</label>
                        <select v-model="newTransaction.category" required>
                            <option v-for="category in categories" :key="category" :value="category">
                                {{ category }}
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>日期</label>
                        <input type="date" v-model="newTransaction.date" required>
                    </div>
                    <div class="form-group">
                        <label>备注</label>
                        <input type="text" v-model="newTransaction.note">
                    </div>
                    <button type="submit">保存</button>
                </form>
            </section>

            <!-- 交易记录列表 -->
            <section v-if="currentView === 'list'" class="transaction-list">
                <h2>交易记录</h2>
                <div class="filters">
                    <input type="date" v-model="filters.startDate">
                    <input type="date" v-model="filters.endDate">
                    <select v-model="filters.category">
                        <option value="">所有类别</option>
                        <option v-for="category in categories" :key="category" :value="category">
                            {{ category }}
                        </option>
                    </select>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>日期</th>
                            <th>类型</th>
                            <th>类别</th>
                            <th>金额</th>
                            <th>备注</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="transaction in filteredTransactions" :key="transaction.id">
                            <td>{{ transaction.date }}</td>
                            <td>{{ transaction.type === 'expense' ? '支出' : '收入' }}</td>
                            <td>{{ transaction.category }}</td>
                            <td>{{ transaction.amount }}</td>
                            <td>{{ transaction.note }}</td>
                            <td>
                                <button @click="editTransaction(transaction)">编辑</button>
                                <button @click="deleteTransaction(transaction.id)">删除</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- 统计图表 -->
            <section v-if="currentView === 'statistics'" class="statistics">
                <h2>收支统计</h2>
                <div class="budget-overview">
                    <h3>本月预算</h3>
                    <div v-for="(budget, category) in budgets" :key="category" class="budget-item">
                        <div class="budget-header">
                            <span>{{ category }}</span>
                            <span>{{ budget.currency }} {{ budget.amount }} / {{ budget.spent }} ({{ budget.currency }})</span>
                        </div>
                        <div class="budget-bar">
                            <div class="budget-bar-fill" :style="{ width: (budget.spent / budget.amount * 100) + '%', backgroundColor: (budget.spent / budget.amount > 1 ? 'var(--danger-color)' : 'var(--primary-color)') }"></div>
                        </div>
                    </div>
                </div>
                <div class="charts">
                    <div class="chart-container">
                        <canvas id="monthlyChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- 设置 -->
            <section v-if="currentView === 'settings'" class="settings">
                <h2>设置</h2>
                <div class="settings-group">
                    <h3>类别管理</h3>
                    <div class="category-manager">
                        <input type="text" v-model="newCategory" placeholder="新类别名称">
                        <button @click="addCategory">添加类别</button>
                        <ul>
                            <li v-for="category in categories" :key="category">
                                {{ category }}
                                <button @click="deleteCategory(category)">删除</button>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="settings-group">
                    <h3>数据管理</h3>
                    <button @click="exportData">导出数据</button>
                    <input type="file" @change="importData" accept=".json">
                </div>
                <div class="settings-group">
                    <h3>预算管理</h3>
                    <div class="budget-manager">
                        <div v-for="(budget, category) in budgets" :key="category" class="budget-row">
                            <span>{{ category }}</span>
                            <input type="number" v-model.number="budget.amount" min="0" step="0.1" :placeholder="'预算金额'">
                            <select v-model="budget.currency">
                                <option v-for="c in currencies" :key="c.code" :value="c.code">{{ c.code }} ({{ c.symbol }})</option>
                            </select>
                            <button @click="saveBudget(category)">保存</button>
                        </div>
                    </div>
                </div>
                <div class="settings-group">
                    <h3>货币设置</h3>
                    <div class="currency-manager">
                        <div class="currency-row">
                            <span>默认货币</span>
                            <select v-model="defaultCurrency">
                                <option v-for="c in currencies" :key="c.code" :value="c.code">{{ c.code }} ({{ c.symbol }})</option>
                            </select>
                        </div>
                        <div class="currency-row">
                            <span>汇率更新</span>
                            <button @click="updateExchangeRates">更新汇率</button>
                            <span v-if="lastExchangeUpdate">上次更新: {{ lastExchangeUpdate }}</span>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="src/js/app.js"></script>
</body>
</html> 